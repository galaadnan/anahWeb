<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>أناه | المذكرة اليومية</title>

    <link rel="stylesheet" href="styles.css" />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;800;900&display=swap" rel="stylesheet" />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/2.5.1/uicons-solid-rounded/css/uicons-solid-rounded.css" />

    <script type="module">
  import { pipeline, env } from 'https://cdn.jsdelivr.net/npm/@xenova/transformers@2.17.1';
  
  // إيقاف البحث في الإنترنت تماماً
  env.allowRemoteModels = false;
  env.localModelPath = './'; 
  
  // إخبار المحرك أننا لن نستخدم نسخة ONNX (هذا يحل إيرور 404 المكتوب في صورتك)
  env.backends.onnx.wasm.proxy = false;

  window.pipeline = pipeline;
</script>
  </head>

  <body class="page-journal has-animated-bg">
    <div class="bg-blobs">
      <div class="blob mint"></div>
      <div class="blob peach"></div>
      <div class="blob purple"></div>
    </div>

    <header class="site-header">
      <div class="shell">
        <nav class="nav">
          <a href="index.html" class="brand">
            <img src="images/anah.jpeg" alt="anah logo" class="brand-icon" />
            <span>أناه</span>
          </a>
          <ul class="nav-links">
            <li><a href="home.html" class="anim-underline">الرئيسية</a></li>
            <li><a href="journal.html" class="active anim-underline">اليوميات</a></li>
            <li><a href="analyze.html" class="anim-underline">تحليل المزاج</a></li>
          </ul>
          <a id="authButton" href="SignOrLogin.html" class="pill-button pill-ghost">تسجيل / دخول</a>
        </nav>
      </div>
    </header>
    
    <main class="shell journal-main journal-container">
      <header class="journal-header-top">
        <div>
          <p class="eyebrow">المذكرة اليومية</p>
          <h1>مساحتك لكتابة يومك، بهدوء.</h1>
          <p class="journal-lead">اكتب ما حدث معك اليوم، قيّم شعورك، وارجع لمذكراتك في أي وقت تحب.</p>
        </div>
        <div class="journal-meta-chip">
          <span>اليوم:</span>
          <span id="journal-today"></span>
        </div>
      </header>

      <section class="journal-split-layout slide-right">
        <aside class="journal-sidebar">
          <section class="journal-card rating-card">
            <h2>قيّم شعورك اليوم</h2>
            <div id="rating" class="rating-stars">
              <button type="button" data-v="1">★</button>
              <button type="button" data-v="2">★</button>
              <button type="button" data-v="3">★</button>
              <button type="button" data-v="4">★</button>
              <button type="button" data-v="5">★</button>
            </div>
            <div id="ratingText" class="rating-text">قيّم يومك: 0/5</div>
          </section>

          <section class="journal-card streak-card">
            <h2>سلسلة الكتابة</h2>
            <div class="streak-row"><span>أيام متتالية</span> <strong id="curStreak">0</strong></div>
            <div class="streak-row"><span>أفضل سلسلة</span> <strong id="bestStreak">0</strong></div>
          </section>

          <button id="showAchv" class="journal-link-btn">
            <i class="fi fi-sr-trophy"></i> عرض الإنجازات
          </button>

          <section id="achievements" class="journal-card achievements-card" hidden>
            <h2>إنجازاتك</h2>
            <div id="achvList" class="achievements-list"></div>
          </section>
        </aside>

        <section class="journal-editor-panel">
          <section class="journal-card editor-card">
            <header class="editor-header">
              <div>
                <h2>مذكرتك لليوم</h2>
                <p class="editor-hint">يمكنك كتابة مذكرة واحدة لكل يوم.</p>
              </div>
            </header>

            <div class="note-info" id="noteInfo">
              <i class="fi fi-sr-info"></i>
              <p>بعد الحفظ، سيظهر لك تحليل MARBERT لمشاعرك مباشرة في جهازك.</p>
            </div>

            <textarea id="note" class="note-area" placeholder="اكتب عن يومك هنا..."></textarea>

            <div class="editor-actions">
              <div class="editor-actions-left">
                <button id="save" class="pill-button pill-primary">حفظ المذكرة</button>
                <button id="clearToday" class="pill-button pill-ghost">مسح مذكرة اليوم</button>
              </div>
              <button id="showAll" class="journal-link-btn">
                <i class="fa-regular fa-folder-open"></i> عرض كل المذكرات
              </button>
            </div>
          </section>
        </section>
      </section>
    </main>

    <div id="viewModal" class="journal-modal" hidden>
      <div class="journal-modal-dialog">
        <button id="closeModal" class="journal-modal-close">×</button>
        <div id="viewContent" class="journal-modal-content"></div>
      </div>
    </div>
<!-- Status Modal (instead of alert) -->
<div id="journalStatusModal" class="journal-modal" hidden>
  <div class="journal-modal-dialog dialog-centered" style="max-width: 420px;">
    <div class="modal-icon" style="font-size: 3rem; margin-bottom: 10px;" id="journalStatusIcon">✅</div>
    <h3 class="modal-title" id="journalStatusTitle">تنبيه</h3>
    <p class="modal-body" id="journalStatusMessage" style="margin-bottom: 18px; color: #555;">
      ...
    </p>
    <button id="closeJournalStatusModal" class="pill-button pill-primary full-width">
      حسنًا
    </button>
  </div>
</div>
    <footer class="site-footer">
      <div class="shell footer-row">
        <div class="footer-left">
          <a href="index.html" class="brand">
            <img src="images/anah.jpeg" alt="anah logo" class="brand-icon" />
            <span>أناه</span>
          </a>
          <span class="footer-copy"> © 2026 أناه </span>
        </div>
      </div>
    </footer>

    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore-compat.js"></script>
    
    <script src="firebase-config.js"></script>
    <script src="utils.js"></script>
  <script src="journal.js?v=1" defer></script>
    <script src="home.js"></script>
  </body>
</html>